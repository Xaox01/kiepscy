<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pełna lista odcinków</title>
    <link rel="icon" href="./img/pazdzioch.png" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.0.4/dist/tailwind.min.css" rel="stylesheet">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HNNSEN84MW"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-HNNSEN84MW');
    </script>

    <style>
        #bmc-button img {
            width: 150px !important;
            height: auto !important;
        }
        #bmc-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col justify-between items-center">
    <header class="w-full fixed top-0 left-0 p-4">
        <img src="./img/pazdzioch.png" alt="Logo" class="h-12">
    </header>

    <main class="flex flex-col items-center justify-center mt-8 w-full">
        <div class="p-6 max-w-2xl mx-auto bg-gray-800 rounded-xl shadow-md space-y-4">
            <div class="text-xl font-medium text-white">Pełna lista odcinków</div>

            <!-- Wyszukiwarka i filtr -->
            <div class="flex space-x-4">
                <input type="text" id="search-input" onkeyup="searchEpisodes()" placeholder="Wyszukaj odcinki..." class="bg-gray-700 rounded-md px-3 py-2 w-full">
                <select id="season-select" onchange="searchEpisodes()" class="bg-gray-700 rounded-md px-3 py-2">
                    <option value="">Wszystkie sezony</option>
                </select>
            </div>

            <!-- Lista odcinków -->
            <ul id="episodes-list" class="space-y-2"></ul>
        </div>
    </main>

    <footer class="flex justify-center items-center space-x-4 pb-4">
        <a href="https://t.me/kiepskikanal" target="_blank">
            <img src="https://cdn-icons-png.flaticon.com/512/2111/2111646.png" alt="Telegram icon" style="width: 50px;">
        </a>
        <a href="index.html" class="px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
            Powrót do strony głównej
        </a>
    </footer>

    <script src="data.js"></script>
    <script>
        const episodesList = document.getElementById('episodes-list');
        const searchInput = document.getElementById('search-input');
        const seasonSelect = document.getElementById('season-select');

        function createEpisodeElement(episode) {
            const listItem = document.createElement('li');

            const link = document.createElement('a');
            link.textContent = `Sezon ${episode.season}, Odcinek ${episode.number}: ${episode.title}`;
            link.href = `${episode.link}`;
            link.classList.add('text-indigo-500', 'hover:text-indigo-600');

            listItem.appendChild(link);

            return listItem;
        }

        let seasons = [...new Set(episodes.map(e => e.season))].sort();
        for(let season of seasons) {
            let option = document.createElement('option');
            option.value = season;
            option.textContent = 'Sezon ' + season;
            seasonSelect.appendChild(option);
        }

        function searchEpisodes() {
            let searchText = searchInput.value.toLowerCase();
            let selectedSeason = seasonSelect.value;

            let filteredEpisodes = episodes.filter(e => {
                let episodeText = `${e.season}.${e.number}. ${e.title}`.toLowerCase();
                let matchSearchText = episodeText.includes(searchText);
                let matchSelectedSeason = !selectedSeason || e.season == selectedSeason;
                return matchSearchText && matchSelectedSeason;
            });

            while(episodesList.firstChild) {
                episodesList.removeChild(episodesList.firstChild);
            }

            for(let episode of filteredEpisodes) {
                episodesList.appendChild(createEpisodeElement(episode));
            }
        }

        searchEpisodes();
    </script>
</body>
</html>
